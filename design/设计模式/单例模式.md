**<span style="font-size: 35px;">ğŸ¤¶ åˆ›å»ºå‹æ¨¡å¼-å•ä¾‹æ¨¡å¼</span>**

---

# æ¦‚è¿°

## æ¨¡å¼å®šä¹‰

å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼Œä¸ºäº†èŠ‚çº¦ç³»ç»Ÿèµ„æºæˆ–è€…æ•°æ®çš„ä¸€è‡´æ€§(æ¯”å¦‚è¯´å…¨å±€çš„`Config`ã€æºå¸¦ä¸Šä¸‹æ–‡ä¿¡æ¯çš„`Context`ç­‰ç­‰)ï¼Œæœ‰æ—¶éœ€è¦ç¡®ä¿ç³»ç»Ÿä¸­æŸä¸ªç±»åªæœ‰å”¯ä¸€ä¸€ä¸ªå®ä¾‹ï¼Œå½“è¿™ä¸ªå”¯ä¸€å®ä¾‹åˆ›å»ºæˆåŠŸä¹‹åï¼Œæˆ‘ä»¬æ— æ³•å†åˆ›å»ºä¸€ä¸ªåŒç±»å‹çš„å…¶ä»–å¯¹è±¡ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½åªèƒ½åŸºäºè¿™ä¸ªå”¯ä¸€å®ä¾‹ã€‚ä¸ºäº†ç¡®ä¿å¯¹è±¡çš„å”¯ä¸€æ€§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å•ä¾‹æ¨¡å¼æ¥å®ç°ï¼Œè¿™å°±æ˜¯å•ä¾‹æ¨¡å¼çš„åŠ¨æœºæ‰€åœ¨ã€‚

> å•ä¾‹æ¨¡å¼(`Singleton Pattern`): ç¡®ä¿æŸä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œè€Œä¸”è‡ªå·±å®ä¾‹åŒ–å¹¶å‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹ï¼Œè¿™ä¸ªç±»ç§°ä¸ºå•ä¾‹ç±»ï¼Œå®ƒæä¾›å…¨å±€è®¿é—®çš„æ–¹æ³•ã€‚å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ã€‚

å•ä¾‹æ¨¡å¼æœ‰ä¸‰ä¸ªè¦ç‚¹ï¼š

1. æŸä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹
2. å®ƒå¿…é¡»è‡ªè¡Œåˆ›å»ºè¿™ä¸ªå®ä¾‹
3. å®ƒå¿…é¡»è‡ªè¡Œå‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹

## æ¨¡å¼ç»“æ„å›¾

å•ä¾‹æ¨¡å¼æ˜¯ç»“æ„æœ€ç®€å•çš„è®¾è®¡æ¨¡å¼ä¸€ï¼Œåœ¨å®ƒçš„æ ¸å¿ƒç»“æ„ä¸­åªåŒ…å«ä¸€ä¸ªè¢«ç§°ä¸ºå•ä¾‹ç±»çš„ç‰¹æ®Šç±»ã€‚å•ä¾‹æ¨¡å¼ç»“æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š

![å•ä¾‹æ¨¡å¼ç»“æ„å›¾](https://vue-admin-imgages.oss-cn-hangzhou.aliyuncs.com/2022-09-18/d8ab5a84-326b-4702-8c27-956764383824_å•ä¾‹æ¨¡å¼ç»“æ„å›¾.png)

å•ä¾‹æ¨¡å¼ç»“æ„å›¾ä¸­åªåŒ…å«ä¸€ä¸ªå•ä¾‹è§’è‰²ï¼š

- `Singletonï¼ˆå•ä¾‹ï¼‰`ï¼šåœ¨å•ä¾‹ç±»çš„å†…éƒ¨å®ç°åªç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼ŒåŒæ—¶å®ƒæä¾›ä¸€ä¸ªé™æ€çš„getInstance()å·¥å‚æ–¹æ³•ï¼Œè®©å®¢æˆ·å¯ä»¥è®¿é—®å®ƒçš„å”¯ä¸€å®ä¾‹ï¼›ä¸ºäº†é˜²æ­¢åœ¨å¤–éƒ¨å¯¹å…¶å®ä¾‹åŒ–ï¼Œå°†å…¶æ„é€ å‡½æ•°è®¾è®¡ä¸ºç§æœ‰ï¼›åœ¨å•ä¾‹ç±»å†…éƒ¨å®šä¹‰äº†ä¸€ä¸ªSingletonç±»å‹çš„é™æ€å¯¹è±¡ï¼Œä½œä¸ºå¤–éƒ¨å…±äº«çš„å”¯ä¸€å®ä¾‹ã€‚



# å•åˆ—æ¨¡å¼çš„6ç§å®ç°æ–¹å¼

## ä¸€ã€å•ä¾‹æ¨¡å¼çš„å®šä¹‰

å®šä¹‰ï¼š ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›è¯¥å®ä¾‹çš„å…¨å±€è®¿é—®ç‚¹ã€‚
è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼šæœ‰äº›å®ä¾‹ï¼Œå…¨å±€åªéœ€è¦ä¸€ä¸ªå°±å¤Ÿäº†ï¼Œä½¿ç”¨å•ä¾‹æ¨¡å¼å°±å¯ä»¥é¿å…ä¸€ä¸ªå…¨å±€ä½¿ç”¨çš„ç±»ï¼Œé¢‘ç¹çš„åˆ›å»ºä¸é”€æ¯ï¼Œè€—è´¹ç³»ç»Ÿèµ„æºã€‚

## äºŒã€å•ä¾‹æ¨¡å¼çš„è®¾è®¡è¦ç´ 

- ä¸€ä¸ªç§æœ‰æ„é€ å‡½æ•° ï¼ˆç¡®ä¿åªèƒ½å•ä¾‹ç±»è‡ªå·±åˆ›å»ºå®ä¾‹ï¼‰
- ä¸€ä¸ªç§æœ‰é™æ€å˜é‡ ï¼ˆç¡®ä¿åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼‰
- ä¸€ä¸ªå…¬æœ‰é™æ€å‡½æ•° ï¼ˆç»™ä½¿ç”¨è€…æä¾›è°ƒç”¨æ–¹æ³•ï¼‰
  ç®€å•æ¥è¯´å°±æ˜¯ï¼Œå•ä¾‹ç±»çš„æ„é€ æ–¹æ³•ä¸è®©å…¶ä»–äººä¿®æ”¹å’Œä½¿ç”¨ï¼›å¹¶ä¸”å•ä¾‹ç±»è‡ªå·±åªåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹ï¼Œå…¶ä»–äººä¹Ÿæ— æ³•ä¿®æ”¹å’Œç›´æ¥ä½¿ç”¨ï¼›ç„¶åå•ä¾‹ç±»æä¾›ä¸€ä¸ªè°ƒç”¨æ–¹æ³•ï¼Œæƒ³ç”¨è¿™ä¸ªå®ä¾‹ï¼Œåªèƒ½è°ƒç”¨ã€‚è¿™æ ·å°±ç¡®ä¿äº†å…¨å±€åªåˆ›å»ºäº†ä¸€æ¬¡å®ä¾‹ã€‚

## ä¸‰ã€å•ä¾‹æ¨¡å¼çš„6ç§å®ç°åŠå„å®ç°çš„ä¼˜ç¼ºç‚¹

### **ï¼ˆä¸€ï¼‰æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰**

**å®ç°ï¼š**

```java
public class Singleton {
     private static Singleton uniqueInstance;

     private Singleton() {

    }

    public static Singleton getUniqueInstance() {
        if (uniqueInstance == null) {
            uniqueInstance = new Singleton();
        }
        return uniqueInstance;
    }
}
```

**è¯´æ˜ï¼š** å…ˆä¸åˆ›å»ºå®ä¾‹ï¼Œå½“ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨æ—¶ï¼Œå†åˆ›å»ºå®ä¾‹ï¼Œæ‰€ä»¥è¢«ç§°ä¸º`æ‡’æ±‰å¼`ã€‚

**ä¼˜ç‚¹ï¼š** å»¶è¿Ÿäº†å®ä¾‹åŒ–ï¼Œå¦‚æœä¸éœ€è¦ä½¿ç”¨è¯¥ç±»ï¼Œå°±ä¸ä¼šè¢«å®ä¾‹åŒ–ï¼ŒèŠ‚çº¦äº†ç³»ç»Ÿèµ„æºã€‚

**ç¼ºç‚¹ï¼š** çº¿ç¨‹ä¸å®‰å…¨ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›å…¥äº† if (uniqueInstance == null) ï¼Œè‹¥æ­¤æ—¶è¿˜æœªå®ä¾‹åŒ–ï¼Œä¹Ÿå°±æ˜¯uniqueInstance == nullï¼Œé‚£ä¹ˆå°±ä¼šæœ‰å¤šä¸ªçº¿ç¨‹æ‰§è¡Œ uniqueInstance = new Singleton(); ï¼Œå°±ä¼šå®ä¾‹åŒ–å¤šä¸ªå®ä¾‹ï¼›

### **ï¼ˆäºŒï¼‰é¥¿æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰**

**å®ç°ï¼š**

```java
public class Singleton {

    private static Singleton uniqueInstance = new Singleton();

    private Singleton() {
    }

    public static Singleton getUniqueInstance() {
        return uniqueInstance;
    }
}
```

**è¯´æ˜ï¼š** å…ˆä¸ç®¡éœ€ä¸éœ€è¦ä½¿ç”¨è¿™ä¸ªå®ä¾‹ï¼Œç›´æ¥å…ˆå®ä¾‹åŒ–å¥½å®ä¾‹ (é¥¿æ­»é¬¼ä¸€æ ·ï¼Œæ‰€ä»¥ç§°ä¸ºé¥¿æ±‰å¼)ï¼Œç„¶åå½“éœ€è¦ä½¿ç”¨çš„æ—¶å€™ï¼Œç›´æ¥è°ƒæ–¹æ³•å°±å¯ä»¥ä½¿ç”¨äº†ã€‚

**ä¼˜ç‚¹ï¼š** æå‰å®ä¾‹åŒ–å¥½äº†ä¸€ä¸ªå®ä¾‹ï¼Œé¿å…äº†çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜çš„å‡ºç°ã€‚

**ç¼ºç‚¹ï¼š** ç›´æ¥å®ä¾‹åŒ–å¥½äº†å®ä¾‹ï¼Œä¸å†å»¶è¿Ÿå®ä¾‹åŒ–ï¼›è‹¥ç³»ç»Ÿæ²¡æœ‰ä½¿ç”¨è¿™ä¸ªå®ä¾‹ï¼Œæˆ–è€…ç³»ç»Ÿè¿è¡Œå¾ˆä¹…ä¹‹åæ‰éœ€è¦ä½¿ç”¨è¿™ä¸ªå®ä¾‹ï¼Œéƒ½ä¼šæ“ä½œç³»ç»Ÿçš„èµ„æºæµªè´¹ã€‚

### **ï¼ˆä¸‰ï¼‰æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰**

å®ç°ï¼š

```java
public class Singleton {
    private static Singleton uniqueInstance;

    private static singleton() {
    }

    private static synchronized Singleton getUinqueInstance() {
        if (uniqueInstance == null) {
            uniqueInstance = new Singleton();
        }
        return uniqueInstance;
    }
}
```

**è¯´æ˜ï¼š** å®ç°å’Œ çº¿ç¨‹ä¸å®‰å…¨çš„æ‡’æ±‰å¼ å‡ ä¹ä¸€æ ·ï¼Œå”¯ä¸€ä¸åŒçš„ç‚¹æ˜¯ï¼Œåœ¨getæ–¹æ³•ä¸Š åŠ äº†ä¸€æŠŠ é”ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œå¤šä¸ªçº¿ç¨‹è®¿é—®ï¼Œæ¯æ¬¡åªæœ‰æ‹¿åˆ°é”çš„çš„çº¿ç¨‹èƒ½å¤Ÿè¿›å…¥è¯¥æ–¹æ³•ï¼Œé¿å…äº†å¤šçº¿ç¨‹ä¸å®‰å…¨é—®é¢˜çš„å‡ºç°ã€‚

**ä¼˜ç‚¹ï¼š** å»¶è¿Ÿå®ä¾‹åŒ–ï¼ŒèŠ‚çº¦äº†èµ„æºï¼Œå¹¶ä¸”æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚

**ç¼ºç‚¹ï¼š** è™½ç„¶è§£å†³äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä½†æ˜¯æ€§èƒ½é™ä½äº†ã€‚å› ä¸ºï¼Œå³ä½¿å®ä¾‹å·²ç»å®ä¾‹åŒ–äº†ï¼Œæ—¢åç»­ä¸ä¼šå†å‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜äº†ï¼Œä½†æ˜¯é”è¿˜åœ¨ï¼Œæ¯æ¬¡è¿˜æ˜¯åªèƒ½æ‹¿åˆ°é”çš„çº¿ç¨‹è¿›å…¥è¯¥æ–¹æ³•ä½¿çº¿ç¨‹é˜»å¡ï¼Œç­‰å¾…æ—¶é—´è¿‡é•¿ã€‚

### **ï¼ˆå››ï¼‰åŒé‡æ£€æŸ¥é”å®ç°ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰**

**å®ç°ï¼š**

```java
public class Singleton {

    private volatile static Singleton uniqueInstance;

    private Singleton() {
    }

    public static Singleton getUniqueInstance() {
        if (uniqueInstance == null) {
            synchronized (Singleton.class) {
                if (uniqueInstance == null) {
                    uniqueInstance = new Singleton();
                }
            }
        }
        return uniqueInstance;
    }  
}
```

**è¯´æ˜:** åŒé‡æ£€æŸ¥æ•°ç›¸å½“äºæ˜¯æ”¹è¿›äº† çº¿ç¨‹å®‰å…¨çš„æ‡’æ±‰å¼ã€‚çº¿ç¨‹å®‰å…¨çš„æ‡’æ±‰å¼ çš„ç¼ºç‚¹æ˜¯æ€§èƒ½é™ä½äº†ï¼Œé€ æˆçš„åŸå› æ˜¯å› ä¸ºå³ä½¿å®ä¾‹å·²ç»å®ä¾‹åŒ–ï¼Œä¾ç„¶æ¯æ¬¡éƒ½ä¼šæœ‰é”ã€‚è€Œç°åœ¨ï¼Œæˆ‘ä»¬å°†é”çš„ä½ç½®å˜äº†ï¼Œå¹¶ä¸”å¤šåŠ äº†ä¸€ä¸ªæ£€æŸ¥ã€‚ ä¹Ÿå°±æ˜¯ï¼Œå…ˆåˆ¤æ–­å®ä¾‹æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œè‹¥å·²ç»å­˜åœ¨äº†ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œåˆ¤æ–­æ–¹æ³•å†…çš„æœ‰é”æ–¹æ³•äº†ã€‚ è€Œå¦‚æœï¼Œè¿˜æ²¡æœ‰å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œå¤šä¸ªçº¿ç¨‹è¿›å»äº†ï¼Œä¹Ÿæ²¡æœ‰äº‹ï¼Œå› ä¸ºé‡Œé¢çš„æ–¹æ³•æœ‰é”ï¼Œåªä¼šè®©ä¸€ä¸ªçº¿ç¨‹è¿›å…¥æœ€å†…å±‚æ–¹æ³•å¹¶å®ä¾‹åŒ–å®ä¾‹ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæœ€å¤šæœ€å¤šï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œä¼šæœ‰çº¿ç¨‹é˜»å¡çš„æƒ…å†µï¼Œåç»­ä¾¿ä¸ä¼šå†æœ‰çº¿ç¨‹é˜»å¡çš„é—®é¢˜ã€‚

**ä¸ºä»€ä¹ˆä½¿ç”¨ volatile å…³é”®å­—ä¿®é¥°äº† uniqueInstance å®ä¾‹å˜é‡?**

uniqueInstance = new Singleton(); è¿™æ®µä»£ç æ‰§è¡Œæ—¶åˆ†ä¸ºä¸‰æ­¥ï¼š

1. ä¸º uniqueInstance åˆ†é…å†…å­˜ç©ºé—´
2. åˆå§‹åŒ– uniqueInstance
3. å°† uniqueInstance æŒ‡å‘åˆ†é…çš„å†…å­˜åœ°å€

æ­£å¸¸çš„æ‰§è¡Œé¡ºåºå½“ç„¶æ˜¯ 1>2>3 ï¼Œä½†æ˜¯ç”±äº JVM å…·æœ‰æŒ‡ä»¤é‡æ’çš„ç‰¹æ€§ï¼Œæ‰§è¡Œé¡ºåºæœ‰å¯èƒ½å˜æˆ 1>3>2ã€‚
å•çº¿ç¨‹ç¯å¢ƒæ—¶ï¼ŒæŒ‡ä»¤é‡æ’å¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼›å¤šçº¿ç¨‹ç¯å¢ƒæ—¶ï¼Œä¼šå¯¼è‡´æœ‰äº›çº¿ç¨‹å¯èƒ½ä¼šè·å–åˆ°è¿˜æ²¡åˆå§‹åŒ–çš„å®ä¾‹ã€‚
ä¾‹å¦‚ï¼šçº¿ç¨‹A åªæ‰§è¡Œäº† 1 å’Œ 3 ï¼Œæ­¤æ—¶çº¿ç¨‹Bæ¥è°ƒç”¨ getUniqueInstance()ï¼Œå‘ç° uniqueInstance ä¸ä¸ºç©ºï¼Œä¾¿è·å– uniqueInstance å®ä¾‹ï¼Œä½†æ˜¯å…¶å®æ­¤æ—¶çš„ uniqueInstance è¿˜æ²¡æœ‰åˆå§‹åŒ–ã€‚
è§£å†³åŠæ³•å°±æ˜¯åŠ ä¸€ä¸ª volatile å…³é”®å­—ä¿®é¥° uniqueInstance ï¼Œvolatile ä¼šç¦æ­¢ JVM çš„æŒ‡ä»¤é‡æ’ï¼Œå°±å¯ä»¥ä¿è¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„å®‰å…¨è¿è¡Œã€‚

**ä¼˜ç‚¹ï¼š** å»¶è¿Ÿå®ä¾‹åŒ–ï¼ŒèŠ‚çº¦äº†èµ„æºï¼›çº¿ç¨‹å®‰å…¨ï¼›å¹¶ä¸”ç›¸å¯¹äºçº¿ç¨‹å®‰å…¨çš„æ‡’æ±‰å¼ï¼Œæ€§èƒ½æé«˜äº†ã€‚

**ç¼ºç‚¹ï¼š** volatile å…³é”®å­—ï¼Œå¯¹æ€§èƒ½ä¹Ÿæœ‰ä¸€äº›å½±å“ã€‚

### **ï¼ˆäº”ï¼‰é™æ€å†…éƒ¨ç±»å®ç°ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰**

**å®ç°ï¼š**

```java
public class Singleton {
    private Singleton() {
    }

    private static class SingletonHolder {
        private static final Singleton INSTANCE = new Singleton();
    }

    public static Singleton getUniqueInstance() {
        return SingletonHolder.INSTANCE;
    }
}
```

**è¯´æ˜ï¼š** é¦–å…ˆï¼Œå½“å¤–éƒ¨ç±» Singleton è¢«åŠ è½½æ—¶ï¼Œé™æ€å†…éƒ¨ç±» SingletonHolder å¹¶æ²¡æœ‰è¢«åŠ è½½è¿›å†…å­˜ã€‚å½“è°ƒç”¨ getUniqueInstance() æ–¹æ³•æ—¶ï¼Œä¼šè¿è¡Œ return SingletonHolder.INSTANCE; ï¼Œè§¦å‘äº† SingletonHolder.INSTANCE ï¼Œæ­¤æ—¶é™æ€å†…éƒ¨ç±» SingletonHolder æ‰ä¼šè¢«åŠ è½½è¿›å†…å­˜ï¼Œå¹¶ä¸”åˆå§‹åŒ– INSTANCE å®ä¾‹ï¼Œè€Œä¸” JVM ä¼šç¡®ä¿ INSTANCE åªè¢«å®ä¾‹åŒ–ä¸€æ¬¡ã€‚

**ä¼˜ç‚¹ï¼š** å»¶è¿Ÿå®ä¾‹åŒ–ï¼ŒèŠ‚çº¦äº†èµ„æºï¼›ä¸”çº¿ç¨‹å®‰å…¨ï¼›æ€§èƒ½ä¹Ÿæé«˜äº†ã€‚

### **ï¼ˆå…­ï¼‰æšä¸¾ç±»å®ç°ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰**

**å®ç°ï¼š**

```java
public enum Singleton {

    INSTANCE;

    //æ·»åŠ è‡ªå·±éœ€è¦çš„æ“ä½œ
    public void doSomeThing() {

    }
}
```

**è¯´æ˜ï¼š** é»˜è®¤æšä¸¾å®ä¾‹çš„åˆ›å»ºå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¸”åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½æ˜¯å•ä¾‹ã€‚

**ä¼˜ç‚¹ï¼š** å†™æ³•ç®€å•ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œå¤©ç„¶é˜²æ­¢åå°„å’Œååºåˆ—åŒ–è°ƒç”¨ã€‚

- **é˜²æ­¢ååºåˆ—åŒ–**
  - åºåˆ—åŒ–ï¼šæŠŠjavaå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—çš„è¿‡ç¨‹ï¼›
  - ååºåˆ—åŒ–ï¼š é€šè¿‡è¿™äº›å­—èŠ‚åºåˆ—åœ¨å†…å­˜ä¸­æ–°å»ºjavaå¯¹è±¡çš„è¿‡ç¨‹ï¼›
  - è¯´æ˜ï¼š ååºåˆ—åŒ– å°†ä¸€ä¸ªå•ä¾‹å®ä¾‹å¯¹è±¡å†™åˆ°ç£ç›˜å†è¯»å›æ¥ï¼Œä»è€Œè·å¾—äº†ä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚
    æˆ‘ä»¬è¦é˜²æ­¢ååºåˆ—åŒ–ï¼Œé¿å…å¾—åˆ°å¤šä¸ªå®ä¾‹ã€‚
    æšä¸¾ç±»å¤©ç„¶é˜²æ­¢ååºåˆ—åŒ–ã€‚
    å…¶ä»–å•ä¾‹æ¨¡å¼ å¯ä»¥é€šè¿‡ é‡å†™ readResolve() æ–¹æ³•ï¼Œä»è€Œé˜²æ­¢ååºåˆ—åŒ–ï¼Œä½¿å®ä¾‹å”¯ä¸€é‡å†™ readResolve() :

```java
private Object readResolve() throws ObjectStreamException{
        return singleton;
}
```

> å…³äºæšä¸¾ç±»æ˜¯å¦‚ä½•é˜²æ­¢å•ä¾‹è¢«ç ´åçš„åŸå› ï¼Œå¯ä»¥é˜…è¯»[ä¸ºä»€ä¹ˆæšä¸¾ç±»æ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ](https://blog.csdn.net/u013151053/article/details/118346012)

# æ¨¡å¼åº”ç”¨

### æ¨¡å¼åœ¨JDKä¸­çš„åº”ç”¨

åœ¨JDKä¸­ï¼Œ`java.lang.Runtime`ä½¿ç”¨äº†`é¥¿æ±‰å¼å•ä¾‹`ï¼Œå¦‚ä¸‹ï¼š

```java
public class Runtime {
    private static Runtime currentRuntime = new Runtime();
    
    public static Runtime getRuntime() {
        return currentRuntime;
    }

    /** Don't let anyone else instantiate this class */
    private Runtime() {}
}
```

### æ¨¡å¼åœ¨å¼€æºé¡¹ç›®ä¸­çš„åº”ç”¨

`Spring`æ¡†æ¶ä¸­è®¸å¤šåœ°æ–¹ä½¿ç”¨äº†`å•ä¾‹æ¨¡å¼`ï¼Œè¿™é‡Œéšä¾¿ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚`org.springframework.aop.framework.ProxyFactoryBean`ä¸­çš„éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š

```java
/**
 * Return the singleton instance of this class's proxy object,
 * lazily creating it if it hasn't been created already.
 * @return the shared singleton proxy
 */
private synchronized Object getSingletonInstance() {
  if (this.singletonInstance == null) {
    this.targetSource = freshTargetSource();
    if (this.autodetectInterfaces && getProxiedInterfaces().length == 0 && !isProxyTargetClass()) {
      // Rely on AOP infrastructure to tell us what interfaces to proxy.
      Class<?> targetClass = getTargetClass();
      if (targetClass == null) {
        throw new FactoryBeanNotInitializedException("Cannot determine target class for proxy");
      }
      setInterfaces(ClassUtils.getAllInterfacesForClass(targetClass, this.proxyClassLoader));
    }
    // Initialize the shared singleton instance.
    super.setFrozen(this.freezeProxy);
    this.singletonInstance = getProxy(createAopProxy());
  }
  return this.singletonInstance;
}
```

# æ¨¡å¼æ€»ç»“

å•ä¾‹æ¨¡å¼ä½œä¸ºä¸€ç§ç›®æ ‡æ˜ç¡®ã€ç»“æ„ç®€å•ã€ç†è§£å®¹æ˜“çš„è®¾è®¡æ¨¡å¼ï¼Œåœ¨è½¯ä»¶å¼€å‘ä¸­ä½¿ç”¨é¢‘ç‡ç›¸å½“é«˜ï¼Œåœ¨å¾ˆå¤šåº”ç”¨è½¯ä»¶å’Œæ¡†æ¶ä¸­éƒ½å¾—ä»¥å¹¿æ³›åº”ç”¨ã€‚

### **ä¸»è¦ä¼˜ç‚¹**

(1) å•ä¾‹æ¨¡å¼æä¾›äº†å¯¹å”¯ä¸€å®ä¾‹çš„å—æ§è®¿é—®ã€‚å› ä¸ºå•ä¾‹ç±»å°è£…äº†å®ƒçš„å”¯ä¸€å®ä¾‹ï¼Œæ‰€ä»¥å®ƒå¯ä»¥ä¸¥æ ¼æ§åˆ¶å®¢æˆ·æ€æ ·ä»¥åŠä½•æ—¶è®¿é—®å®ƒã€‚

(2) ç”±äºåœ¨ç³»ç»Ÿå†…å­˜ä¸­åªå­˜åœ¨ä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤å¯ä»¥èŠ‚çº¦ç³»ç»Ÿèµ„æºï¼Œå¯¹äºä¸€äº›éœ€è¦é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çš„å¯¹è±¡å•ä¾‹æ¨¡å¼æ— ç–‘å¯ä»¥æé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚

(3) å…è®¸å¯å˜æ•°ç›®çš„å®ä¾‹ã€‚åŸºäºå•ä¾‹æ¨¡å¼æˆ‘ä»¬å¯ä»¥è¿›è¡Œæ‰©å±•ï¼Œä½¿ç”¨ä¸å•ä¾‹æ§åˆ¶ç›¸ä¼¼çš„æ–¹æ³•æ¥è·å¾—æŒ‡å®šä¸ªæ•°çš„å¯¹è±¡å®ä¾‹ï¼Œæ—¢èŠ‚çœç³»ç»Ÿèµ„æºï¼Œåˆè§£å†³äº†å•ä¾‹å•ä¾‹å¯¹è±¡å…±äº«è¿‡å¤šæœ‰æŸæ€§èƒ½çš„é—®é¢˜ã€‚

### **åº”ç”¨åœºæ™¯ä¸¾ä¾‹ï¼š**

- ç½‘ç«™è®¡æ•°å™¨ã€‚
- åº”ç”¨ç¨‹åºçš„æ—¥å¿—åº”ç”¨ã€‚
- Webé¡¹ç›®ä¸­çš„é…ç½®å¯¹è±¡çš„è¯»å–ã€‚
- æ•°æ®åº“è¿æ¥æ± ã€‚
- å¤šçº¿ç¨‹æ± ã€‚
- ......

### **ä½¿ç”¨åœºæ™¯æ€»ç»“ï¼š**

- é¢‘ç¹å®ä¾‹åŒ–ç„¶ååˆé”€æ¯çš„å¯¹è±¡ï¼Œä½¿ç”¨å•ä¾‹æ¨¡å¼å¯ä»¥æé«˜æ€§èƒ½ã€‚
- ç»å¸¸ä½¿ç”¨çš„å¯¹è±¡ï¼Œä½†å®ä¾‹åŒ–æ—¶è€—è´¹æ—¶é—´æˆ–è€…èµ„æºå¤šï¼Œå¦‚æ•°æ®åº“è¿æ¥æ± ï¼Œä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œå¯ä»¥æé«˜æ€§èƒ½ï¼Œé™ä½èµ„æºæŸåã€‚
- ä½¿ç”¨çº¿ç¨‹æ± ä¹‹ç±»çš„æ§åˆ¶èµ„æºæ—¶ï¼Œä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œå¯ä»¥æ–¹ä¾¿èµ„æºä¹‹é—´çš„é€šä¿¡ã€‚



# å‚è€ƒæ–‡ç« 

- [åˆ˜ä¼Ÿã€Šè®¾è®¡æ¨¡å¼çš„è‰ºæœ¯ä¹‹é“(è½¯ä»¶å¼€å‘äººå‘˜å†…åŠŸä¿®ç‚¼ä¹‹é“)ã€‹](https://blog.csdn.net/LoveLion/article/details/17517213)