# ğŸ˜‡ æ•°æ®ç»“æ„åŸºç¡€ - ä¼¸å±•æ ‘

---

## åŸºç¡€æ¦‚å¿µ

`ä¼¸å±•æ ‘(Splay Tree)`æ˜¯ç‰¹æ®Šçš„äºŒå‰æŸ¥æ‰¾æ ‘ã€‚
å®ƒçš„ç‰¹æ®Šæ˜¯æŒ‡ï¼Œå®ƒé™¤äº†æœ¬èº«æ˜¯æ£µäºŒå‰æŸ¥æ‰¾æ ‘ä¹‹å¤–ï¼Œå®ƒè¿˜å…·å¤‡ä¸€ä¸ªç‰¹ç‚¹: **å½“æŸä¸ªèŠ‚ç‚¹è¢«è®¿é—®æ—¶ï¼Œä¼¸å±•æ ‘ä¼šé€šè¿‡æ—‹è½¬ä½¿è¯¥èŠ‚ç‚¹æˆä¸ºæ ‘æ ¹**ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œä¸‹æ¬¡è¦è®¿é—®è¯¥èŠ‚ç‚¹æ—¶ï¼Œèƒ½å¤Ÿè¿…é€Ÿçš„è®¿é—®åˆ°è¯¥èŠ‚ç‚¹ã€‚



## Javaå®ç°ä¼¸å±•æ ‘

### 1.åŸºæœ¬å®šä¹‰

```java
public class SplayTree<T extends Comparable<T>> {

    private SplayTreeNode<T> mRoot;    // æ ¹ç»“ç‚¹

    public class SplayTreeNode<T extends Comparable<T>> {
        T key;                // å…³é”®å­—(é”®å€¼)
        SplayTreeNode<T> left;    // å·¦å­©å­
        SplayTreeNode<T> right;    // å³å­©å­

        public SplayTreeNode() {
            this.left = null;
            this.right = null;
        }

        public SplayTreeNode(T key, SplayTreeNode<T> left, SplayTreeNode<T> right) {
            this.key = key;
            this.left = left;
            this.right = right;
        }
    }

        ...
}
```

SplayTreeæ˜¯ä¼¸å±•æ ‘ï¼Œè€ŒSplayTreeNodeæ˜¯ä¼¸å±•æ ‘èŠ‚ç‚¹ã€‚åœ¨æ­¤ï¼Œæˆ‘å°†SplayTreeNodeå®šä¹‰ä¸ºSplayTreeçš„å†…éƒ¨ç±»ã€‚åœ¨ä¼¸å±•æ ‘SplayTreeä¸­åŒ…å«äº†ä¼¸å±•æ ‘çš„æ ¹èŠ‚ç‚¹mRootã€‚SplayTreeNodeåŒ…æ‹¬çš„å‡ ä¸ªç»„æˆå…ƒç´ :

(01) key -- æ˜¯å…³é”®å­—ï¼Œæ˜¯ç”¨æ¥å¯¹ä¼¸å±•æ ‘çš„èŠ‚ç‚¹è¿›è¡Œæ’åºçš„ã€‚

(02) left -- æ˜¯å·¦å­©å­ã€‚

(03) right -- æ˜¯å³å­©å­ã€‚

 

### 2.æ—‹è½¬

æ—‹è½¬æ˜¯ä¼¸å±•æ ‘ä¸­éœ€è¦é‡ç‚¹å…³æ³¨çš„ï¼Œå®ƒçš„ä»£ç å¦‚ä¸‹ï¼š

```java
/* 
 * æ—‹è½¬keyå¯¹åº”çš„èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹ï¼Œå¹¶è¿”å›æ ¹èŠ‚ç‚¹ã€‚
 *
 * æ³¨æ„ï¼š
 *   (a)ï¼šä¼¸å±•æ ‘ä¸­å­˜åœ¨"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"ã€‚
 *          å°†"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚
 *   (b)ï¼šä¼¸å±•æ ‘ä¸­ä¸å­˜åœ¨"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"ï¼Œå¹¶ä¸”key < tree.keyã€‚
 *      b-1 "é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„å‰é©±èŠ‚ç‚¹å­˜åœ¨çš„è¯ï¼Œå°†"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„å‰é©±èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚
 *      b-2 "é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„å‰é©±èŠ‚ç‚¹å­˜åœ¨çš„è¯ï¼Œåˆ™æ„å‘³ç€ï¼Œkeyæ¯”æ ‘ä¸­ä»»ä½•é”®å€¼éƒ½å°ï¼Œé‚£ä¹ˆæ­¤æ—¶ï¼Œå°†æœ€å°èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚
 *   (c)ï¼šä¼¸å±•æ ‘ä¸­ä¸å­˜åœ¨"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"ï¼Œå¹¶ä¸”key > tree.keyã€‚
 *      c-1 "é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„åç»§èŠ‚ç‚¹å­˜åœ¨çš„è¯ï¼Œå°†"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„åç»§èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚
 *      c-2 "é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„åç»§èŠ‚ç‚¹ä¸å­˜åœ¨çš„è¯ï¼Œåˆ™æ„å‘³ç€ï¼Œkeyæ¯”æ ‘ä¸­ä»»ä½•é”®å€¼éƒ½å¤§ï¼Œé‚£ä¹ˆæ­¤æ—¶ï¼Œå°†æœ€å¤§èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚
 */
private SplayTreeNode<T> splay(SplayTreeNode<T> tree, T key) {
    if (tree == null) 
        return tree;

    SplayTreeNode<T> N = new SplayTreeNode<T>();
    SplayTreeNode<T> l = N;
    SplayTreeNode<T> r = N;
    SplayTreeNode<T> c;

    for (;;) {

        int cmp = key.compareTo(tree.key);
        if (cmp < 0) {

            if (tree.left == null)
                break;

            if (key.compareTo(tree.left.key) < 0) {
                c = tree.left;                           /* rotate right */
                tree.left = c.right;
                c.right = tree;
                tree = c;
                if (tree.left == null) 
                    break;
            }
            r.left = tree;                               /* link right */
            r = tree;
            tree = tree.left;
        } else if (cmp > 0) {

            if (tree.right == null) 
                break;

            if (key.compareTo(tree.right.key) > 0) {
                c = tree.right;                          /* rotate left */
                tree.right = c.left;
                c.left = tree;
                tree = c;
                if (tree.right == null) 
                    break;
            }

            l.right = tree;                              /* link left */
            l = tree;
            tree = tree.right;
        } else {
            break;
        }
    }

    l.right = tree.left;                                /* assemble */
    r.left = tree.right;
    tree.left = N.right;
    tree.right = N.left;

    return tree;
}

public void splay(T key) {
    mRoot = splay(mRoot, key);
}
```

ä¸Šé¢çš„ä»£ç çš„ä½œç”¨ï¼šå°†"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ï¼Œå¹¶è¿”å›æ ¹èŠ‚ç‚¹ã€‚å®ƒçš„å¤„ç†æƒ…å†µå…±åŒ…æ‹¬ï¼š

**(a)ï¼šä¼¸å±•æ ‘ä¸­å­˜åœ¨"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"ã€‚**
    å°†"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚

**(b)ï¼šä¼¸å±•æ ‘ä¸­ä¸å­˜åœ¨"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"ï¼Œå¹¶ä¸”key < tree->keyã€‚**
    b-1) "é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„å‰é©±èŠ‚ç‚¹å­˜åœ¨çš„è¯ï¼Œå°†"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„å‰é©±èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚
    b-2) "é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„å‰é©±èŠ‚ç‚¹å­˜åœ¨çš„è¯ï¼Œåˆ™æ„å‘³ç€ï¼Œkeyæ¯”æ ‘ä¸­ä»»ä½•é”®å€¼éƒ½å°ï¼Œé‚£ä¹ˆæ­¤æ—¶ï¼Œå°†æœ€å°èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚

**(c)ï¼šä¼¸å±•æ ‘ä¸­ä¸å­˜åœ¨"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"ï¼Œå¹¶ä¸”key > tree->keyã€‚**
    c-1) "é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„åç»§èŠ‚ç‚¹å­˜åœ¨çš„è¯ï¼Œå°†"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„åç»§èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚
    c-2) "é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„åç»§èŠ‚ç‚¹ä¸å­˜åœ¨çš„è¯ï¼Œåˆ™æ„å‘³ç€ï¼Œkeyæ¯”æ ‘ä¸­ä»»ä½•é”®å€¼éƒ½å¤§ï¼Œé‚£ä¹ˆæ­¤æ—¶ï¼Œå°†æœ€å¤§èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚ 

ä¸‹é¢åˆ—ä¸¾ä¸ªä¾‹å­åˆ†åˆ«å¯¹aè¿›è¡Œè¯´æ˜ã€‚

åœ¨ä¸‹é¢çš„ä¼¸å±•æ ‘ä¸­æŸ¥æ‰¾10ï¼Œï¼Œå…±åŒ…æ‹¬"å³æ—‹" --> "å³é“¾æ¥" --> "ç»„åˆ"è¿™3æ­¥ã€‚

![img](https://vue-admin-imgages.oss-cn-hangzhou.aliyuncs.com/2022-09-25/c001ff4e-c39b-4fe9-8b20-f933a81fe672_ä¼¸å±•æ ‘.jpg)

 

#### 01, å³æ—‹

å¯¹åº”ä»£ç ä¸­çš„"rotate right"éƒ¨åˆ†

![img](https://vue-admin-imgages.oss-cn-hangzhou.aliyuncs.com/2022-09-25/3acfbea0-71ef-48ac-81b3-17fedc359b4f_å³æ—‹.jpg)

 

#### 02, å³é“¾æ¥

å¯¹åº”ä»£ç ä¸­çš„"link right"éƒ¨åˆ†

![img](https://vue-admin-imgages.oss-cn-hangzhou.aliyuncs.com/2022-09-25/bdb698a8-d1fd-48c3-8149-babf5574406e_å³é“¾æ¥.jpg)

 

#### 03, ç»„åˆ

å¯¹åº”ä»£ç ä¸­çš„"assemble"éƒ¨åˆ†

![img](https://vue-admin-imgages.oss-cn-hangzhou.aliyuncs.com/2022-09-25/765d114e-012c-48cd-888f-b5f5df2e105a_ç»„åˆ.jpg)

æç¤ºï¼šå¦‚æœåœ¨ä¸Šé¢çš„ä¼¸å±•æ ‘ä¸­æŸ¥æ‰¾"70"ï¼Œåˆ™æ­£å¥½ä¸"ç¤ºä¾‹1"å¯¹ç§°ï¼Œè€Œå¯¹åº”çš„æ“ä½œåˆ™åˆ†åˆ«æ˜¯"rotate left", "link left"å’Œ"assemble"ã€‚
å…¶å®ƒçš„æƒ…å†µï¼Œä¾‹å¦‚"æŸ¥æ‰¾15æ˜¯b-1çš„æƒ…å†µï¼ŒæŸ¥æ‰¾5æ˜¯b-2çš„æƒ…å†µ"ç­‰ç­‰ï¼Œè¿™äº›éƒ½æ¯”è¾ƒç®€å•ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±åˆ†æã€‚

### 3.æ’å…¥

æ’å…¥ä»£ç 

```java
/* 
* å°†ç»“ç‚¹æ’å…¥åˆ°ä¼¸å±•æ ‘ä¸­ï¼Œå¹¶è¿”å›æ ¹èŠ‚ç‚¹
 *
 * å‚æ•°è¯´æ˜ï¼š
 *     tree ä¼¸å±•æ ‘çš„
 *     z æ’å…¥çš„ç»“ç‚¹
 */
private SplayTreeNode<T> insert(SplayTreeNode<T> tree, SplayTreeNode<T> z) {
    int cmp;
    SplayTreeNode<T> y = null;
    SplayTreeNode<T> x = tree;

    // æŸ¥æ‰¾zçš„æ’å…¥ä½ç½®
    while (x != null) {
        y = x;
        cmp = z.key.compareTo(x.key);
        if (cmp < 0)
            x = x.left;
        else if (cmp > 0)
            x = x.right;
        else {
            System.out.printf("ä¸å…è®¸æ’å…¥ç›¸åŒèŠ‚ç‚¹(%d)!\n", z.key);
            z=null;
            return tree;
        }
    }

    if (y==null)
        tree = z;
    else {
        cmp = z.key.compareTo(y.key);
        if (cmp < 0)
            y.left = z;
        else
            y.right = z;
    }

    return tree;
}

public void insert(T key) {
    SplayTreeNode<T> z=new SplayTreeNode<T>(key,null,null);

    // å¦‚æœæ–°å»ºç»“ç‚¹å¤±è´¥ï¼Œåˆ™è¿”å›ã€‚
    if ((z=new SplayTreeNode<T>(key,null,null)) == null)
        return ;

    // æ’å…¥èŠ‚ç‚¹
    mRoot = insert(mRoot, z);
    // å°†èŠ‚ç‚¹(key)æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹
    mRoot = splay(mRoot, key);
}
```

insert(key)æ˜¯æä¾›ç»™å¤–éƒ¨çš„æ¥å£ï¼Œå®ƒçš„ä½œç”¨æ˜¯æ–°å»ºèŠ‚ç‚¹(èŠ‚ç‚¹çš„é”®å€¼ä¸ºkey)ï¼Œå¹¶å°†èŠ‚ç‚¹æ’å…¥åˆ°ä¼¸å±•æ ‘ä¸­ï¼›ç„¶åï¼Œå°†è¯¥èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚
insert(tree, z)æ˜¯å†…éƒ¨æ¥å£ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†èŠ‚ç‚¹zæ’å…¥åˆ°treeä¸­ã€‚insert(tree, z)åœ¨å°†zæ’å…¥åˆ°treeä¸­æ—¶ï¼Œä»…ä»…åªå°†treeå½“ä½œæ˜¯ä¸€æ£µäºŒå‰æŸ¥æ‰¾æ ‘ï¼Œè€Œä¸”ä¸å…è®¸æ’å…¥ç›¸åŒèŠ‚ç‚¹ã€‚

 

### 4. åˆ é™¤

åˆ é™¤ä»£ç 

```java
/* 
 * åˆ é™¤ç»“ç‚¹(z)ï¼Œå¹¶è¿”å›è¢«åˆ é™¤çš„ç»“ç‚¹
 *
 * å‚æ•°è¯´æ˜ï¼š
 *     bst ä¼¸å±•æ ‘
 *     z åˆ é™¤çš„ç»“ç‚¹
 */
private SplayTreeNode<T> remove(SplayTreeNode<T> tree, T key) {
    SplayTreeNode<T> x;

    if (tree == null) 
        return null;

    // æŸ¥æ‰¾é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹ï¼Œæ‰¾ä¸åˆ°çš„è¯ç›´æ¥è¿”å›ã€‚
    if (search(tree, key) == null)
        return tree;

    // å°†keyå¯¹åº”çš„èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚
    tree = splay(tree, key);

    if (tree.left != null) {
        // å°†"treeçš„å‰é©±èŠ‚ç‚¹"æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹
        x = splay(tree.left, key);
        // ç§»é™¤treeèŠ‚ç‚¹
        x.right = tree.right;
    }
    else
        x = tree.right;

    tree = null;

    return x;
}

public void remove(T key) {
    mRoot = remove(mRoot, key);
}
```

remove(key)æ˜¯å¤–éƒ¨æ¥å£ï¼Œremove(tree, key)æ˜¯å†…éƒ¨æ¥å£ã€‚
remove(tree, key)çš„ä½œç”¨æ˜¯ï¼šåˆ é™¤ä¼¸å±•æ ‘ä¸­é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹ã€‚
å®ƒä¼šå…ˆåœ¨ä¼¸å±•æ ‘ä¸­æŸ¥æ‰¾é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹ã€‚è‹¥æ²¡æœ‰æ‰¾åˆ°çš„è¯ï¼Œåˆ™ç›´æ¥è¿”å›ã€‚è‹¥æ‰¾åˆ°çš„è¯ï¼Œåˆ™å°†è¯¥èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ï¼Œç„¶åå†åˆ é™¤è¯¥èŠ‚ç‚¹ã€‚


å…³äº"å‰åºéå†"ã€"ä¸­åºéå†"ã€"ååºéå†"ã€"æœ€å¤§å€¼"ã€"æœ€å°å€¼"ã€"æŸ¥æ‰¾"ã€"æ‰“å°ä¼¸å±•æ ‘"ã€"é”€æ¯ä¼¸å±•æ ‘"ç­‰æ¥å£å°±ä¸å†å•ç‹¬ä»‹ç»äº†ï¼ŒPlease RTFSC(Read The Fucking Source Code)ï¼è¿™äº›æ¥å£ï¼Œä¸å‰é¢ä»‹ç»çš„"äºŒå‰æŸ¥æ‰¾æ ‘"ã€"AVLæ ‘"çš„ç›¸å…³æ¥å£éƒ½æ˜¯ç±»ä¼¼çš„ã€‚



## ä¼¸å±•æ ‘çš„å®Œæ•´ä»£ç 

```java
/**
 * Java è¯­è¨€: ä¼¸å±•æ ‘
 *
 * @author skywang
 * @date 2014/02/03
 */

public class SplayTree<T extends Comparable<T>> {

    private SplayTreeNode<T> mRoot;    // æ ¹ç»“ç‚¹

    public class SplayTreeNode<T extends Comparable<T>> {
        T key;                // å…³é”®å­—(é”®å€¼)
        SplayTreeNode<T> left;    // å·¦å­©å­
        SplayTreeNode<T> right;    // å³å­©å­

        public SplayTreeNode() {
            this.left = null;
            this.right = null;
        }

        public SplayTreeNode(T key, SplayTreeNode<T> left, SplayTreeNode<T> right) {
            this.key = key;
            this.left = left;
            this.right = right;
        }
    }

    public SplayTree() {
        mRoot=null;
    }

    /*
     * å‰åºéå†"ä¼¸å±•æ ‘"
     */
    private void preOrder(SplayTreeNode<T> tree) {
        if(tree != null) {
            System.out.print(tree.key+" ");
            preOrder(tree.left);
            preOrder(tree.right);
        }
    }

    public void preOrder() {
        preOrder(mRoot);
    }

    /*
     * ä¸­åºéå†"ä¼¸å±•æ ‘"
     */
    private void inOrder(SplayTreeNode<T> tree) {
        if(tree != null) {
            inOrder(tree.left);
            System.out.print(tree.key+" ");
            inOrder(tree.right);
        }
    }

    public void inOrder() {
        inOrder(mRoot);
    }


    /*
     * ååºéå†"ä¼¸å±•æ ‘"
     */
    private void postOrder(SplayTreeNode<T> tree) {
        if(tree != null)
        {
            postOrder(tree.left);
            postOrder(tree.right);
            System.out.print(tree.key+" ");
        }
    }

    public void postOrder() {
        postOrder(mRoot);
    }


    /*
     * (é€’å½’å®ç°)æŸ¥æ‰¾"ä¼¸å±•æ ‘x"ä¸­é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹
     */
    private SplayTreeNode<T> search(SplayTreeNode<T> x, T key) {
        if (x==null)
            return x;

        int cmp = key.compareTo(x.key);
        if (cmp < 0)
            return search(x.left, key);
        else if (cmp > 0)
            return search(x.right, key);
        else
            return x;
    }

    public SplayTreeNode<T> search(T key) {
        return search(mRoot, key);
    }

    /*
     * (éé€’å½’å®ç°)æŸ¥æ‰¾"ä¼¸å±•æ ‘x"ä¸­é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹
     */
    private SplayTreeNode<T> iterativeSearch(SplayTreeNode<T> x, T key) {
        while (x!=null) {
            int cmp = key.compareTo(x.key);

            if (cmp < 0)
                x = x.left;
            else if (cmp > 0)
                x = x.right;
            else
                return x;
        }

        return x;
    }

    public SplayTreeNode<T> iterativeSearch(T key) {
        return iterativeSearch(mRoot, key);
    }

    /*
     * æŸ¥æ‰¾æœ€å°ç»“ç‚¹ï¼šè¿”å›treeä¸ºæ ¹ç»“ç‚¹çš„ä¼¸å±•æ ‘çš„æœ€å°ç»“ç‚¹ã€‚
     */
    private SplayTreeNode<T> minimum(SplayTreeNode<T> tree) {
        if (tree == null)
            return null;

        while(tree.left != null)
            tree = tree.left;
        return tree;
    }

    public T minimum() {
        SplayTreeNode<T> p = minimum(mRoot);
        if (p != null)
            return p.key;

        return null;
    }

    /*
     * æŸ¥æ‰¾æœ€å¤§ç»“ç‚¹ï¼šè¿”å›treeä¸ºæ ¹ç»“ç‚¹çš„ä¼¸å±•æ ‘çš„æœ€å¤§ç»“ç‚¹ã€‚
     */
    private SplayTreeNode<T> maximum(SplayTreeNode<T> tree) {
        if (tree == null)
            return null;

        while(tree.right != null)
            tree = tree.right;
        return tree;
    }

    public T maximum() {
        SplayTreeNode<T> p = maximum(mRoot);
        if (p != null)
            return p.key;

        return null;
    }

    /*
     * æ—‹è½¬keyå¯¹åº”çš„èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹ï¼Œå¹¶è¿”å›æ ¹èŠ‚ç‚¹ã€‚
     *
     * æ³¨æ„ï¼š
     *   (a)ï¼šä¼¸å±•æ ‘ä¸­å­˜åœ¨"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"ã€‚
     *          å°†"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚
     *   (b)ï¼šä¼¸å±•æ ‘ä¸­ä¸å­˜åœ¨"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"ï¼Œå¹¶ä¸”key < tree.keyã€‚
     *      b-1 "é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„å‰é©±èŠ‚ç‚¹å­˜åœ¨çš„è¯ï¼Œå°†"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„å‰é©±èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚
     *      b-2 "é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„å‰é©±èŠ‚ç‚¹å­˜åœ¨çš„è¯ï¼Œåˆ™æ„å‘³ç€ï¼Œkeyæ¯”æ ‘ä¸­ä»»ä½•é”®å€¼éƒ½å°ï¼Œé‚£ä¹ˆæ­¤æ—¶ï¼Œå°†æœ€å°èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚
     *   (c)ï¼šä¼¸å±•æ ‘ä¸­ä¸å­˜åœ¨"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"ï¼Œå¹¶ä¸”key > tree.keyã€‚
     *      c-1 "é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„åç»§èŠ‚ç‚¹å­˜åœ¨çš„è¯ï¼Œå°†"é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„åç»§èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚
     *      c-2 "é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹"çš„åç»§èŠ‚ç‚¹ä¸å­˜åœ¨çš„è¯ï¼Œåˆ™æ„å‘³ç€ï¼Œkeyæ¯”æ ‘ä¸­ä»»ä½•é”®å€¼éƒ½å¤§ï¼Œé‚£ä¹ˆæ­¤æ—¶ï¼Œå°†æœ€å¤§èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚
     */
    private SplayTreeNode<T> splay(SplayTreeNode<T> tree, T key) {
        if (tree == null)
            return tree;

        SplayTreeNode<T> N = new SplayTreeNode<T>();
        SplayTreeNode<T> l = N;
        SplayTreeNode<T> r = N;
        SplayTreeNode<T> c;

        for (;;) {

            int cmp = key.compareTo(tree.key);
            if (cmp < 0) {

                if (tree.left == null)
                    break;

                if (key.compareTo(tree.left.key) < 0) {
                    c = tree.left;                           /* rotate right */
                    tree.left = c.right;
                    c.right = tree;
                    tree = c;
                    if (tree.left == null)
                        break;
                }
                r.left = tree;                               /* link right */
                r = tree;
                tree = tree.left;
            } else if (cmp > 0) {

                if (tree.right == null)
                    break;

                if (key.compareTo(tree.right.key) > 0) {
                    c = tree.right;                          /* rotate left */
                    tree.right = c.left;
                    c.left = tree;
                    tree = c;
                    if (tree.right == null)
                        break;
                }

                l.right = tree;                              /* link left */
                l = tree;
                tree = tree.right;
            } else {
                break;
            }
        }

        l.right = tree.left;                                /* assemble */
        r.left = tree.right;
        tree.left = N.right;
        tree.right = N.left;

        return tree;
    }

    public void splay(T key) {
        mRoot = splay(mRoot, key);
    }

    /*
     * å°†ç»“ç‚¹æ’å…¥åˆ°ä¼¸å±•æ ‘ä¸­ï¼Œå¹¶è¿”å›æ ¹èŠ‚ç‚¹
     *
     * å‚æ•°è¯´æ˜ï¼š
     *     tree ä¼¸å±•æ ‘çš„
     *     z æ’å…¥çš„ç»“ç‚¹
     */
    private SplayTreeNode<T> insert(SplayTreeNode<T> tree, SplayTreeNode<T> z) {
        int cmp;
        SplayTreeNode<T> y = null;
        SplayTreeNode<T> x = tree;

        // æŸ¥æ‰¾zçš„æ’å…¥ä½ç½®
        while (x != null) {
            y = x;
            cmp = z.key.compareTo(x.key);
            if (cmp < 0)
                x = x.left;
            else if (cmp > 0)
                x = x.right;
            else {
                System.out.printf("ä¸å…è®¸æ’å…¥ç›¸åŒèŠ‚ç‚¹(%d)!\n", z.key);
                z=null;
                return tree;
            }
        }

        if (y==null)
            tree = z;
        else {
            cmp = z.key.compareTo(y.key);
            if (cmp < 0)
                y.left = z;
            else
                y.right = z;
        }

        return tree;
    }

    public void insert(T key) {
        SplayTreeNode<T> z=new SplayTreeNode<T>(key,null,null);

        // å¦‚æœæ–°å»ºç»“ç‚¹å¤±è´¥ï¼Œåˆ™è¿”å›ã€‚
        if ((z=new SplayTreeNode<T>(key,null,null)) == null)
            return ;

        // æ’å…¥èŠ‚ç‚¹
        mRoot = insert(mRoot, z);
        // å°†èŠ‚ç‚¹(key)æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹
        mRoot = splay(mRoot, key);
    }

    /*
     * åˆ é™¤ç»“ç‚¹(z)ï¼Œå¹¶è¿”å›è¢«åˆ é™¤çš„ç»“ç‚¹
     *
     * å‚æ•°è¯´æ˜ï¼š
     *     bst ä¼¸å±•æ ‘
     *     z åˆ é™¤çš„ç»“ç‚¹
     */
    private SplayTreeNode<T> remove(SplayTreeNode<T> tree, T key) {
        SplayTreeNode<T> x;

        if (tree == null)
            return null;

        // æŸ¥æ‰¾é”®å€¼ä¸ºkeyçš„èŠ‚ç‚¹ï¼Œæ‰¾ä¸åˆ°çš„è¯ç›´æ¥è¿”å›ã€‚
        if (search(tree, key) == null)
            return tree;

        // å°†keyå¯¹åº”çš„èŠ‚ç‚¹æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹ã€‚
        tree = splay(tree, key);

        if (tree.left != null) {
            // å°†"treeçš„å‰é©±èŠ‚ç‚¹"æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹
            x = splay(tree.left, key);
            // ç§»é™¤treeèŠ‚ç‚¹
            x.right = tree.right;
        }
        else
            x = tree.right;

        tree = null;

        return x;
    }

    public void remove(T key) {
        mRoot = remove(mRoot, key);
    }

    /*
     * é”€æ¯ä¼¸å±•æ ‘
     */
    private void destroy(SplayTreeNode<T> tree) {
        if (tree==null)
            return ;

        if (tree.left != null)
            destroy(tree.left);
        if (tree.right != null)
            destroy(tree.right);

        tree=null;
    }

    public void clear() {
        destroy(mRoot);
        mRoot = null;
    }

    /*
     * æ‰“å°"ä¼¸å±•æ ‘"
     *
     * key        -- èŠ‚ç‚¹çš„é”®å€¼
     * direction  --  0ï¼Œè¡¨ç¤ºè¯¥èŠ‚ç‚¹æ˜¯æ ¹èŠ‚ç‚¹;
     *               -1ï¼Œè¡¨ç¤ºè¯¥èŠ‚ç‚¹æ˜¯å®ƒçš„çˆ¶ç»“ç‚¹çš„å·¦å­©å­;
     *                1ï¼Œè¡¨ç¤ºè¯¥èŠ‚ç‚¹æ˜¯å®ƒçš„çˆ¶ç»“ç‚¹çš„å³å­©å­ã€‚
     */
    private void print(SplayTreeNode<T> tree, T key, int direction) {

        if(tree != null) {

            if(direction==0)    // treeæ˜¯æ ¹èŠ‚ç‚¹
                System.out.printf("%2d is root\n", tree.key);
            else                // treeæ˜¯åˆ†æ”¯èŠ‚ç‚¹
                System.out.printf("%2d is %2d's %6s child\n", tree.key, key, direction==1?"right" : "left");

            print(tree.left, tree.key, -1);
            print(tree.right,tree.key,  1);
        }
    }

    public void print() {
        if (mRoot != null)
            print(mRoot, mRoot.key, 0);
    }
}
```



## ä¼¸å±•æ ‘çš„æµ‹è¯•ä»£ç 

```java
/**
 * Java è¯­è¨€: ä¼¸å±•æ ‘
 *
 * @author skywang
 * @date 2014/02/03
 */
public class SplayTreeTest {

    private static final int arr[] = {10,50,40,30,20,60};

    public static void main(String[] args) {
        int i, ilen;
        SplayTree<Integer> tree=new SplayTree<Integer>();

        System.out.print("== ä¾æ¬¡æ·»åŠ : ");
        ilen = arr.length;
        for(i=0; i<ilen; i++) {
            System.out.print(arr[i]+" ");
            tree.insert(arr[i]);
        }

        System.out.print("\n== å‰åºéå†: ");
        tree.preOrder();

        System.out.print("\n== ä¸­åºéå†: ");
        tree.inOrder();

        System.out.print("\n== ååºéå†: ");
        tree.postOrder();
        System.out.println();

        System.out.println("== æœ€å°å€¼: "+ tree.minimum());
        System.out.println("== æœ€å¤§å€¼: "+ tree.maximum());
        System.out.println("== æ ‘çš„è¯¦ç»†ä¿¡æ¯: ");
        tree.print();

        i = 30;
        System.out.printf("\n== æ—‹è½¬èŠ‚ç‚¹(%d)ä¸ºæ ¹èŠ‚ç‚¹\n", i);
        tree.splay(i);
        System.out.printf("== æ ‘çš„è¯¦ç»†ä¿¡æ¯: \n");
        tree.print();

        // é”€æ¯äºŒå‰æ ‘
        tree.clear();
    }
}
```

ä¼¸å±•æ ‘çš„æµ‹è¯•ç¨‹åºè¿è¡Œç»“æœå¦‚ä¸‹ï¼š

```java
== ä¾æ¬¡æ·»åŠ : 10 50 40 30 20 60 
== å‰åºéå†: 60 30 20 10 50 40 
== ä¸­åºéå†: 10 20 30 40 50 60 
== ååºéå†: 10 20 40 50 30 60 
== æœ€å°å€¼: 10
== æœ€å¤§å€¼: 60
== æ ‘çš„è¯¦ç»†ä¿¡æ¯: 
60 is root
30 is 60's   left child
20 is 30's   left child
10 is 20's   left child
50 is 30's  right child
40 is 50's   left child

== æ—‹è½¬èŠ‚ç‚¹(30)ä¸ºæ ¹èŠ‚ç‚¹
== æ ‘çš„è¯¦ç»†ä¿¡æ¯: 
30 is root
20 is 30's   left child
10 is 20's   left child
60 is 30's  right child
50 is 60's   left child
40 is 50's   left child
```

æµ‹è¯•ç¨‹åºçš„ä¸»è¦æµç¨‹æ˜¯ï¼šæ–°å»ºä¼¸å±•æ ‘ï¼Œç„¶åå‘ä¼¸å±•æ ‘ä¸­ä¾æ¬¡æ’å…¥10,50,40,30,20,60ã€‚æ’å…¥å®Œæ¯•è¿™äº›æ•°æ®ä¹‹åï¼Œä¼¸å±•æ ‘çš„èŠ‚ç‚¹æ˜¯60ï¼›æ­¤æ—¶ï¼Œå†æ—‹è½¬èŠ‚ç‚¹ï¼Œä½¿å¾—30æˆä¸ºæ ¹èŠ‚ç‚¹ã€‚
ä¾æ¬¡æ’å…¥10,50,40,30,20,60ç¤ºæ„å›¾å¦‚ä¸‹ï¼š

![img](https://vue-admin-imgages.oss-cn-hangzhou.aliyuncs.com/2022-09-25/532f1e2f-95b6-4dea-8f3a-0d8bbb3437fb_ä¼¸å±•å¼test1.jpg)

å°†30æ—‹è½¬ä¸ºæ ¹èŠ‚ç‚¹çš„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š

![img](https://vue-admin-imgages.oss-cn-hangzhou.aliyuncs.com/2022-09-25/45ded2eb-d360-4054-81fa-adc3560fdd1b_ä¼¸å±•å¼test2.jpg)



## å‚è€ƒæ–‡ç« 

- [ä¼¸å±•æ ‘(ä¸‰)ä¹‹ Javaçš„å®ç°](https://www.cnblogs.com/skywang12345/p/3604286.html)

